/*! ng-dialog - v0.5.1 (https://github.com/likeastore/ngDialog) */
!function(a,b){"undefined"!=typeof module&&module.exports?"undefined"==typeof angular?module.exports=b(require("angular")):module.exports=b(angular):"function"==typeof define&&define.amd?define(["angular"],b):b(a.angular)}(this,function(a){"use strict";var b=a.module("ngDialog",[]),c=a.element,d=a.isDefined,e=(document.body||document.documentElement).style,f=d(e.animation)||d(e.WebkitAnimation)||d(e.MozAnimation)||d(e.MsAnimation)||d(e.OAnimation),g="animationend webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend",h="a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]",i="ngdialog-disabled-animation",j={html:!1,body:!1},k={},l=[],m=!1;return b.provider("ngDialog",function(){var b=this.defaults={className:"ngdialog-theme-default",disableAnimation:!1,plain:!1,showClose:!0,closeByDocument:!0,closeByEscape:!0,closeByNavigation:!1,appendTo:!1,preCloseCallback:!1,overlay:!0,cache:!0,trapFocus:!0,preserveFocus:!0,ariaAuto:!0,ariaRole:null,ariaLabelledById:null,ariaLabelledBySelector:null,ariaDescribedById:null,ariaDescribedBySelector:null};this.setForceHtmlReload=function(a){j.html=a||!1},this.setForceBodyReload=function(a){j.body=a||!1},this.setDefaults=function(c){a.extend(b,c)};var d,e=0,n=0,o={};this.$get=["$document","$templateCache","$compile","$q","$http","$rootScope","$timeout","$window","$controller","$injector","ElementScroll",function(p,q,r,s,t,u,v,w,x,y,z){var A=[];a.forEach(["html","body"],function(a){if(A[a]=p.find(a),j[a]){var b=B.getRouterLocationEventName();u.$on(b,function(){A[a]=p.find(a)})}});var B={onDocumentKeydown:function(a){27===a.keyCode&&C.close("$escape")},activate:function(a){var b=a.data("$ngDialogOptions");b.trapFocus&&(a.on("keydown",B.onTrapFocusKeydown),A.body.on("keydown",B.onTrapFocusKeydown))},deactivate:function(a){a.off("keydown",B.onTrapFocusKeydown),A.body.off("keydown",B.onTrapFocusKeydown)},deactivateAll:function(){a.forEach(function(b){var c=a.element(b);B.deactivate(c)})},setBodyPadding:function(a){var b=parseInt(A.body.css("padding-right")||0,10);A.body.css("padding-right",b+a+"px"),A.body.data("ng-dialog-original-padding",b)},resetBodyPadding:function(){var a=A.body.data("ng-dialog-original-padding");a?A.body.css("padding-right",a+"px"):A.body.css("padding-right","")},performCloseDialog:function(b,c){var e=b.data("$ngDialogOptions"),h=b.attr("id"),i=k[h];if(i){if("undefined"!=typeof w.Hammer){var j=i.hammerTime;j.off("tap",d),j.destroy&&j.destroy(),delete i.hammerTime}else b.unbind("click");1===n&&A.body.unbind("keydown",B.onDocumentKeydown),b.hasClass("ngdialog-closing")||(n-=1);var p=b.data("$ngDialogPreviousFocus");p&&p.focus(),u.$broadcast("ngDialog.closing",b,c),n=0>n?0:n,z.enableScrolling(a.element(w)),f&&!e.disableAnimation?(i.$destroy(),b.unbind(g).bind(g,function(){B.closeDialogElement(b,c)}).addClass("ngdialog-closing")):(i.$destroy(),B.closeDialogElement(b,c)),o[h]&&(o[h].resolve({id:h,value:c,$dialog:b,remainingDialogs:n}),delete o[h]),k[h]&&delete k[h],l.splice(l.indexOf(h),1),l.length||(A.body.unbind("keydown",B.onDocumentKeydown),m=!1)}},closeDialogElement:function(a,b){a.remove(),0===n&&(A.html.removeClass("ngdialog-open"),A.body.removeClass("ngdialog-open"),B.resetBodyPadding()),u.$broadcast("ngDialog.closed",a,b)},closeDialog:function(b,c){var d=b.data("$ngDialogPreCloseCallback");if(d&&a.isFunction(d)){var e=d.call(b,c);a.isObject(e)?e.closePromise?e.closePromise.then(function(){B.performCloseDialog(b,c)}):e.then(function(){B.performCloseDialog(b,c)},function(){}):e!==!1&&B.performCloseDialog(b,c)}else B.performCloseDialog(b,c)},onTrapFocusKeydown:function(b){var c,d=a.element(b.currentTarget);if(d.hasClass("ngdialog"))c=d;else if(c=B.getActiveDialog(),null===c)return;var e=9===b.keyCode,f=b.shiftKey===!0;e&&B.handleTab(c,b,f)},handleTab:function(a,b,c){var d=B.getFocusableElements(a);if(0===d.length)return void(document.activeElement&&document.activeElement.blur());var e=document.activeElement,f=Array.prototype.indexOf.call(d,e),g=-1===f,h=0===f,i=f===d.length-1,j=!1;c?(g||h)&&(d[d.length-1].focus(),j=!0):(g||i)&&(d[0].focus(),j=!0),j&&(b.preventDefault(),b.stopPropagation())},autoFocus:function(a){var b=a[0],d=b.querySelector("*[autofocus]");if(null===d||(d.focus(),document.activeElement!==d)){var e=B.getFocusableElements(a);if(e.length>0)return void e[0].focus();var f=B.filterVisibleElements(b.querySelectorAll("h1,h2,h3,h4,h5,h6,p,span"));if(f.length>0){var g=f[0];c(g).attr("tabindex","-1").css("outline","0"),g.focus()}}},getFocusableElements:function(a){var b=a[0],c=b.querySelectorAll(h),d=B.filterTabbableElements(c);return B.filterVisibleElements(d)},filterTabbableElements:function(a){for(var b=[],d=0;d<a.length;d++){var e=a[d];"-1"!==c(e).attr("tabindex")&&b.push(e)}return b},filterVisibleElements:function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];(d.offsetWidth>0||d.offsetHeight>0)&&b.push(d)}return b},getActiveDialog:function(){var a=document.querySelectorAll(".ngdialog");return 0===a.length?null:c(a[a.length-1])},applyAriaAttributes:function(a,b){if(b.ariaAuto){if(!b.ariaRole){var c=B.getFocusableElements(a).length>0?"dialog":"alertdialog";b.ariaRole=c}b.ariaLabelledBySelector||(b.ariaLabelledBySelector="h1,h2,h3,h4,h5,h6"),b.ariaDescribedBySelector||(b.ariaDescribedBySelector="article,section,p")}b.ariaRole&&a.attr("role",b.ariaRole),B.applyAriaAttribute(a,"aria-labelledby",b.ariaLabelledById,b.ariaLabelledBySelector),B.applyAriaAttribute(a,"aria-describedby",b.ariaDescribedById,b.ariaDescribedBySelector)},applyAriaAttribute:function(a,b,d,e){if(d&&a.attr(b,d),e){var f=a.attr("id"),g=a[0].querySelector(e);if(!g)return;var h=f+"-"+b;return c(g).attr("id",h),a.attr(b,h),h}},detectUIRouter:function(){try{return a.module("ui.router"),!0}catch(b){return!1}},getRouterLocationEventName:function(){return B.detectUIRouter()?"$stateChangeSuccess":"$locationChangeSuccess"}},C={open:function(f){function g(a,b){return u.$broadcast("ngDialog.templateLoading",a),t.get(a,b||{}).then(function(b){return u.$broadcast("ngDialog.templateLoaded",a),b.data||""})}function h(b){return b?a.isString(b)&&j.plain?b:"boolean"!=typeof j.cache||j.cache?g(b,{cache:q}):g(b,{cache:!1}):"Empty template"}var j=a.copy(b),p=++e,D="ngdialog"+p;l.push(D),f=f||{},a.extend(j,f);var E;o[D]=E=s.defer();var F;k[D]=F=a.isObject(j.scope)?j.scope.$new():u.$new();var G,H,I=a.extend({},j.resolve);return a.forEach(I,function(b,c){I[c]=a.isString(b)?y.get(b):y.invoke(b,null,null,c)}),s.all({template:h(j.template||j.templateUrl),locals:s.all(I)}).then(function(b){var e=b.template,f=b.locals;j.showClose&&(e+='<div class="ngdialog-close"></div>');var g=j.overlay?"":" ngdialog-no-overlay";if(G=c('<div id="ngdialog'+p+'" class="ngdialog'+g+'"></div>'),G.html(j.overlay?'<div class="ngdialog-overlay"></div><div class="ngdialog-content" role="document">'+e+"</div>":'<div class="ngdialog-content" role="document">'+e+"</div>"),G.data("$ngDialogOptions",j),F.ngDialogId=D,j.data&&a.isString(j.data)){var h=j.data.replace(/^\s*/,"")[0];F.ngDialogData="{"===h||"["===h?a.fromJson(j.data):j.data,F.ngDialogData.ngDialogId=D}else j.data&&a.isObject(j.data)&&(F.ngDialogData=j.data,F.ngDialogData.ngDialogId=D);if(j.controller&&(a.isString(j.controller)||a.isArray(j.controller)||a.isFunction(j.controller))){var k;j.controllerAs&&a.isString(j.controllerAs)&&(k=j.controllerAs);var l=x(j.controller,a.extend(f,{$scope:F,$element:G}),null,k);G.data("$ngDialogControllerController",l)}if(j.className&&G.addClass(j.className),j.disableAnimation&&G.addClass(i),H=j.appendTo&&a.isString(j.appendTo)?a.element(document.querySelector(j.appendTo)):A.body,B.applyAriaAttributes(G,j),j.preCloseCallback){var o;a.isFunction(j.preCloseCallback)?o=j.preCloseCallback:a.isString(j.preCloseCallback)&&F&&(a.isFunction(F[j.preCloseCallback])?o=F[j.preCloseCallback]:F.$parent&&a.isFunction(F.$parent[j.preCloseCallback])?o=F.$parent[j.preCloseCallback]:u&&a.isFunction(u[j.preCloseCallback])&&(o=u[j.preCloseCallback])),o&&G.data("$ngDialogPreCloseCallback",o)}if(F.closeThisDialog=function(a){B.closeDialog(G,a)},v(function(){var b=document.querySelectorAll(".ngdialog");B.deactivateAll(b),r(G)(F);var c=w.innerWidth-A.body.prop("clientWidth");A.html.addClass("ngdialog-open"),A.body.addClass("ngdialog-open");var d=c-(w.innerWidth-A.body.prop("clientWidth"));d>0&&B.setBodyPadding(d),H.append(G),z.disableScrolling(a.element(w)),G.on("mousewheel DOMMouseScroll touchmove scroll keydown",function(a){a.stopPropagation()}),B.activate(G),j.trapFocus&&B.autoFocus(G),j.name?u.$broadcast("ngDialog.opened",{dialog:G,name:j.name}):u.$broadcast("ngDialog.opened",G)}),m||(A.body.bind("keydown",B.onDocumentKeydown),m=!0),j.closeByNavigation){var q=B.getRouterLocationEventName();u.$on(q,function(){B.closeDialog(G)})}if(j.preserveFocus&&G.data("$ngDialogPreviousFocus",document.activeElement),d=function(a){var b=j.closeByDocument?c(a.target).hasClass("ngdialog-overlay"):!1,d=c(a.target).hasClass("ngdialog-close");(b||d)&&C.close(G.attr("id"),d?"$closeButton":"$document")},"undefined"!=typeof w.Hammer){var s=F.hammerTime=w.Hammer(G[0]);s.on("tap",d)}else G.bind("click",d);return n+=1,C}),{id:D,closePromise:E.promise,close:function(a){B.closeDialog(G,a)}}},openConfirm:function(b){var d=s.defer(),e={closeByEscape:!1,closeByDocument:!1};a.extend(e,b),e.scope=a.isObject(e.scope)?e.scope.$new():u.$new(),e.scope.confirm=function(a){d.resolve(a);var b=c(document.getElementById(f.id));B.performCloseDialog(b,a)};var f=C.open(e);return f.closePromise.then(function(a){return a?d.reject(a.value):d.reject()}),d.promise},isOpen:function(a){var b=c(document.getElementById(a));return b.length>0},close:function(a,b){var d=c(document.getElementById(a));if(d.length)B.closeDialog(d,b);else if("$escape"===a){var e=l[l.length-1];d=c(document.getElementById(e)),d.data("$ngDialogOptions").closeByEscape&&B.closeDialog(d,b)}else C.closeAll(b);return C},closeAll:function(a){for(var b=document.querySelectorAll(".ngdialog"),d=b.length-1;d>=0;d--){var e=b[d];B.closeDialog(c(e),a)}},getOpenDialogs:function(){return l},getDefaults:function(){return b}};return C}]}),b.service("ElementScroll",["$window",function(b){function c(c,d){this.opts=a.extend({handleWheel:!0,handleScrollbar:!0,handleKeys:!0,scrollEventKeys:[32,33,34,35,36,37,38,39,40]},d),this.$container=c,this.$document=a.element(b.document),this.lockToScrollPos=[0,0],this.scrollDisabled=!1;var e=this;this._handleScrollbar=function(){var a=e.$container[0];a===b?a.scrollTo(e.lockToScrollPos[0],e.lockToScrollPos[1]):(a.scrollLeft=e.lockToScrollPos[0],a.scrollTop=e.lockToScrollPos[1])},this._handleKeydown=function(a){for(var b=0;b<e.opts.scrollEventKeys.length;b++)if(a.keyCode===e.opts.scrollEventKeys[b])return void a.preventDefault()},this._handleWheel=function(a){a.preventDefault()}}function d(a,b){var d=parseInt(a.data("_disableScrollId"),10);return d||(g++,d=g,a.data("_disableScrollId",d),a.on("$destroy",function(){f[d]=void 0})),f[d]||(f[d]=new c(a,b)),d}var e,f={},g=1;e=c.prototype,e.disable=function(){var b=this;if(!b.scrollDisabled){if(b.scrollDisabled=!0,b.opts.handleWheel&&b.$container.on("mousewheel DOMMouseScroll touchmove",b._handleWheel),b.opts.handleScrollbar){var c=b.$container[0];b.lockToScrollPos=[a.isNumber(c.scrollX)?c.scrollX:c.scrollLeft,a.isNumber(c.scrollY)?c.scrollY:c.scrollTop],b.$container.on("scroll",b._handleScrollbar)}b.opts.handleKeys&&b.$document.on("keydown",b._handleKeydown)}},e.undo=function(){var a=this;a.scrollDisabled&&(a.scrollDisabled=!1,a.opts.handleWheel&&a.$container.off("mousewheel DOMMouseScroll touchmove",a._handleWheel),a.opts.handleScrollbar&&a.$container.off("scroll",a._handleScrollbar),a.opts.handleKeys&&a.$document.off("keydown",a._handleKeydown))};var h=this;h.disableScrolling=function(a,b){var c=d(a,b);f[c].disable()},h.enableScrolling=function(a,b){var c=d(a,b);f[c].undo()}}]),b.directive("ngDialog",["ngDialog",function(b){return{restrict:"A",scope:{ngDialogScope:"="},link:function(c,d,e){d.on("click",function(d){d.preventDefault();var f=a.isDefined(c.ngDialogScope)?c.ngDialogScope:"noScope";a.isDefined(e.ngDialogClosePrevious)&&b.close(e.ngDialogClosePrevious);var g=b.getDefaults();b.open({template:e.ngDialog,className:e.ngDialogClass||g.className,controller:e.ngDialogController,controllerAs:e.ngDialogControllerAs,bindToController:e.ngDialogBindToController,scope:f,data:e.ngDialogData,showClose:"false"===e.ngDialogShowClose?!1:"true"===e.ngDialogShowClose?!0:g.showClose,closeByDocument:"false"===e.ngDialogCloseByDocument?!1:"true"===e.ngDialogCloseByDocument?!0:g.closeByDocument,closeByEscape:"false"===e.ngDialogCloseByEscape?!1:"true"===e.ngDialogCloseByEscape?!0:g.closeByEscape,overlay:"false"===e.ngDialogOverlay?!1:"true"===e.ngDialogOverlay?!0:g.overlay,preCloseCallback:e.ngDialogPreCloseCallback||g.preCloseCallback})})}}}]),b});